module Main where

import Text.Printf

stocks_01 = ["Basf"    , "Henkel",   "Muni Re", "Nokia"    , "IBM"]        
y2015_01  = [(285,2.80), (119,1.31), (91,7.75), (2434,0.14), ( 32,5.0/u1)]
y2016_01  = [(337,2.90), (119,1.47), (91,8.25), (2434,0.26), (106,5.5/u1)]
y2017_01  = [(337,3.00), (119,1.62), (91,8.60), (2434,0.17), (106,5.9/u1)]
y2018_01  = [(337,3.10), (119,1.79), (91,8.60), (2434,0.19), (106,6.3/u)]
y2019_01  = [(337,3.26), (119,1.88), (91,9.10), (2434,0.20), (200,6.3/u)]
y2020_01  = [(337,3.26), (119,1.88), (91,9.10), (2434,0.20), (200,6.3/u)] 


stocks_02 = ["I E STOXX", "Altria",     "PMI"    ,    "V S&P 500", "V DW"]
y2015_02  = [(   0,0   ), (  0,0   ),     (0,0   ),     (0,0   ),  (0,0)]
y2016_02  = [(   0,0   ), (  0,0   ),     (0,0   ),     (0,0   ),  (0,0)] 
y2017_02  = [( 200,0.63), (100,0.0 ),    (50,0.0 ),     (0,0   ),  (0,0)]  
y2018_02  = [(1000,1.5 ), (200,2.76/u), (100,4.28/u), (180,0.70),  (0,0)]      
y2019_02  = [(1000,1.6 ), (400,3.20/u), (300,4.56/u), (226,0.70),  (100,2)]      
y2020_02  = [(1000,1.6 ), (400,3.20/u), (300,4.56/u), (226,0.70),  (100,2)]      


stocks_03 = ["AAPL"      ,"V EM"]
y2015_03  = [(0,0)       , (0,0)]          
y2016_03  = [(0,0)       , (0,0)] 
y2017_03  = [(0,0)       , (0,0)] 
y2018_03  = [(0,0)       , (0,0)]  
y2019_03  = [(100,3.16/u), (104,3)]
y2020_03  = [(100,3.16/u), (104,3)]


stocks = stocks_01 ++ stocks_02 ++ stocks_03

y2015  = y2015_01  ++ y2015_02  ++ y2015_03
y2016  = y2016_01  ++ y2016_02  ++ y2016_03
y2017  = y2017_01  ++ y2017_02  ++ y2017_03
y2018  = y2018_01  ++ y2018_02  ++ y2018_03
y2019  = y2019_01  ++ y2019_02  ++ y2019_03
y2020  = y2020_01  ++ y2020_02  ++ y2020_03

shares= (stocks,[y2015,y2016,y2017,y2018,y2019,y2020])

u1 = 1.1
u  = 1.2

dividend (n,v) = n * v

sumDividends s = map  (sum . map dividend) (snd s) 

freibetrag = 0 

format :: Int -> Double -> String 
format y s = printf "%4d: %8.2f %8.2f" y s (freibetrag+(s-freibetrag)*0.73) :: String 

pretty :: [Double] -> [String]
pretty = zipWith format [2015..] 

main = do 
    mapM_ putStrLn (pretty $ sumDividends shares)
--               
